%% LaTeX2e file `f'
%% generated by the `filecontents' environment
%% from source `Informe' on 2019/11/04.
%%
 desfasaje=[];
 dv=[];
 for i=1:15
 filename=string(i);
 dist=430
 M=csvread(filename+'.csv',2,0);
 
 fileID = fopen(filename+'.txt','r');
 C1 = textscan(fileID,'%s',1,'delimiter','\n', 'headerlines',15);
 fclose(fileID);
 
 fileID = fopen(filename+'.txt','r');
 C2 = textscan(fileID,'%s %s %s %f',1,'headerlines',15);
 fclose(fileID);
 if (strfind(string(C1),'MSa'))>0
 ts=1/(str2num(string(C2(4)))*1e6)
 else
 ts=1/(str2num(string(C2(4)))*1e3)
 end
 
 t=M(:,[1]);
 v1=smooth(M(:,[2]),30);
 v2=smooth(M(:,[3]),30);
 [v1M,v1Mt]=findpeaks(v1,'MinPeakDistance',dist);
 [v2M,v2Mt]=findpeaks(v2,'MinPeakDistance',dist);
 
 A=size(v1M,1);
 B=size(v2M,1);
 diferencia=abs(A-B);
 if A<B
 for i=1:diferencia
 v1M=[v1M; v1M(end)]
 v1Mt=[v1Mt; v1Mt(end)+median(diff(v1Mt))]
 end
 else
 for i=1:diferencia
 v2M=[v2M; v2M(end)]
 v2Mt=[v2Mt; v2Mt(end)+median(diff(v2Mt))]
 end
 end
 dtV=v2Mt-v1Mt;
 dt=median(dtV);
 dvV=abs(v2M)./abs(v1M);
 dv=[dv;median(dvV)];
 periodo=(median(diff(v1Mt))*ts);
 %odoirep=[odoirep;(median(diff(v1Mt))*ts)];
 angulo = (dt*ts*360/periodo)
 if angulo>360
 angulo=angulo-360
 elseif angulo <0
 angulo = angulo+360
 end
 desfasaje=[desfasaje;angulo];
 frecuencia=[frecuencia;2*pi*1/periodo]
 end
 ganancia=real(10*log10(abs(dv)))
 yyaxis left
 semilogx(frecuencia,ganancia)
 yyaxis right
 semilogx(frecuencia,-1.*desfasaje)
 
